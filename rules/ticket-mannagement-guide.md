---
trigger: model_decision
description: 本规范为AI在协助工程开发任务管理时，提供了标准化的“Ticket”（任务卡片）模板。作为独立开发者，将开发任务结构化、可追踪是确保项目有序推进的关键。本指南定义了一个全面的Ticket模板，涵盖了从任务描述、技术背景到验收标准和测试要点等所有必要信息。AI在接收开发指令时，应引导用户或直接将模糊的需求转化为这样一个结构化的Ticket，从而确保每一个开发任务都有清晰的目标、范围和完成标准。
---

# 规范：工程任务卡片管理 (Engineering Ticket Management)

## 核心目标

为了将产品需求有效地转化为可执行的开发任务，我们使用标准化的“Ticket”格式。这确保了每个任务都有明确的目标、范围和验收标准，便于跟踪和执行。

AI在接收到一个开发请求时，应协助将该请求格式化为以下的Ticket结构。

---

## Engineering Ticket 模板

当需要创建一个新的开发任务时，无论是bug修复、新功能开发还是技术重构，都**必须**使用以下模板。

```markdown
# Engineering Ticket: [简明扼要的标题]
# 示例: 实现用户密码重置API端点

## 1. 描述 (Description)
[详细解释需要实现的功能、修复的bug或执行的任务。这里应包含“用户故事”的上下文。]
(示例: "根据产品设计，我们需要为用户提供一个安全的方式来重置他们的密码。此任务专注于实现后端的API逻辑，包括生成token和验证token。")

## 2. 技术背景 (Technical Context)
[提供相关的技术信息、架构考量或系统限制。]
(示例: "认证系统当前使用FastAPI-Users和JWT。密码使用bcrypt进行哈希。需要与现有的邮件服务(FastAPI-Mail)集成来发送重置邮件。")

## 3. 实现细节/建议方案 (Implementation Details / Suggested Plan)
[提出建议的实现步骤或技术要点。这部分是建议性的，开发者可以有更好的方案。]
1.  创建一个新的POST API端点 `/auth/forgot-password`。
2.  实现一个服务函数来生成有时效性（如1小时）的安全token。
3.  集成邮件服务，将包含token的重置链接发送给用户。
4.  创建一个新的POST API端点 `/auth/reset-password`，用于验证token并更新密码。
5.  添加相应的错误处理和日志记录。

## 4. 验收标准 (Acceptance Criteria)
[**这是最重要的部分**。定义了“完成”的标准，必须是具体、可测试的。]
1.  **当** 用户向 `/auth/forgot-password` 发送一个已存在的邮箱地址 **时**，系统应返回200 OK，并发送一封密码重置邮件。
2.  **当** 用户发送一个不存在的邮箱地址 **时**，系统为安全起见仍返回200 OK，但不发送邮件。
3.  重置邮件中的token在1小时后过期。
4.  **当** 用户使用有效的token向 `/auth/reset-password` 提交新密码 **时**，密码被成功更新，且该token失效。
5.  **当** 用户使用无效或过期的token **时**，系统返回400 Bad Request错误。
6.  所有密码重置尝试（成功和失败）都被记录在日志中。

## 5. 测试要点 (Testing Considerations)
[提醒开发者需要特别注意的测试场景。]
-  测试邮箱地址的有效性验证。
-  验证token的过期逻辑是否正常工作。
-  测试新密码的强度是否符合要求。
-  安全测试：尝试重放token、篡改token等。

## 6. 依赖关系 (Dependencies)
[列出此任务的任何前置或并行依赖。]
-  依赖: [前端密码重置页面的完成]
-  依赖: [邮件服务的API凭证配置]

## 7. 资源 (Resources)
[提供相关的文档、设计稿或API链接。]
-  [UI设计稿链接](https://...)
-  [相关API文档](https://...)

## 8. 估算 (Estimation)
**Story Points**: [使用斐波那契数: 1, 2, 3, 5, 8, 13]
(示例: 5)